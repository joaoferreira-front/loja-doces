<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Admin - Doces G & J</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            padding: 2rem;
            background: #f4f4f4;
        }

        h1,
        h2 {
            color: #333;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            margin-bottom: 2rem;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        th,
        td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background: #D48C95;
            color: white;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .btn {
            padding: 0.5rem 1rem;
            background: #333;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            cursor: pointer;
            border: none;
        }
    </style>
</head>

<body>
    <div class="container">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h1>Painel Administrativo</h1>
            <a href="http://localhost:5173" class="btn">Voltar para Loja</a>
        </div>

        <!-- Card de Total de Vendas -->
        <div
            style="background: white; padding: 1.5rem; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 2rem; display: flex; align-items: center; gap: 1rem; border-left: 5px solid #28a745; margin-top: 1rem;">
            <div style="background: #e8f5e9; padding: 1rem; border-radius: 50%;">
                <span style="font-size: 2rem;">üí∞</span>
            </div>
            <div>
                <h3 style="margin: 0; color: #666; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px;">
                    Total Vendido</h3>
                <p style="margin: 0; font-size: 2rem; font-weight: bold; color: #28a745;"
                    th:text="'R$ ' + ${totalVendas}">R$ 0.00</p>
            </div>
        </div>

        <h2>üì¶ Estoque de Produtos</h2>
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Pre√ßo</th>
                    <th>Estoque</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="produto : ${produtos}">
                    <td th:text="${produto.id}">1</td>
                    <td th:text="${produto.nome}">Doce</td>
                    <td th:text="'R$ ' + ${produto.preco}">R$ 0.00</td>
                    <td th:text="${produto.quantidade}"
                        th:style="${produto.quantidade == 0} ? 'color: red; font-weight: bold;' : ''">10</td>
                </tr>
            </tbody>
        </table>

        <h2>üìù Pedidos Recentes</h2>
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Cliente</th>
                    <th>Data</th>
                    <th>Valor Total</th>
                    <th>Pagamento</th>
                    <th>Status</th>
                    <th>Itens</th>
                    <th>A√ß√µes</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="pedido : ${pedidos}">
                    <td th:text="${pedido.id}">1</td>
                    <td>
                        <span th:if="${pedido.cliente != null}"
                            th:text="${pedido.cliente.nome} + ' (' + ${pedido.cliente.email} + ')'">Cliente</span>
                        <span th:if="${pedido.cliente == null}" style="color: red;">An√¥nimo</span>
                    </td>
                    <td th:text="${#temporals.format(pedido.dataPedido, 'dd/MM/yyyy HH:mm')}">01/01/2024</td>
                    <td th:text="'R$ ' + ${pedido.valorTotal}">R$ 0.00</td>
                    <td th:text="${pedido.formaPagamento}">PIX</td>
                    <td>
                        <span th:text="${pedido.status}"
                            th:style="${pedido.status == T(com.candystore.enums.StatusPedido).CANCELADO} ? 'color: red; font-weight: bold;' : 'color: green; font-weight: bold;'">
                            CONFIRMADO
                        </span>
                    </td>
                    <td>
                        <ul style="margin: 0; padding-left: 1rem;">
                            <li th:each="item : ${pedido.itens}"
                                th:text="${item.quantidade} + 'x ' + ${item.produto.nome}">
                                1x Doce</li>
                        </ul>
                    </td>
                    <td>
                        <div style="display: flex; gap: 0.5rem;">
                            <form
                                th:if="${pedido.status != T(com.candystore.enums.StatusPedido).CANCELADO} and ${pedido.status != T(com.candystore.enums.StatusPedido).ENTREGUE}"
                                th:action="@{/admin/avancar-status/{id}(id=${pedido.id})}" method="post">
                                <button type="submit" class="btn"
                                    style="background: #5bc0de; font-size: 0.8rem;">Avan√ßar Status ‚û°Ô∏è</button>
                            </form>
                            <form th:if="${pedido.status != T(com.candystore.enums.StatusPedido).CANCELADO}"
                                th:action="@{/admin/cancelar/{id}(id=${pedido.id})}" method="post"
                                onsubmit="return confirm('Tem certeza que deseja cancelar este pedido? O estoque ser√° restaurado.');">
                                <button type="submit" class="btn"
                                    style="background: #d9534f; font-size: 0.8rem;">Cancelar</button>
                            </form>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2>üîê √öltimos Acessos</h2>
        <table>
            <thead>
                <tr>
                    <th>Data/Hora</th>
                    <th>Usu√°rio</th>
                    <th>Status</th>
                    <th>Mensagem</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="log : ${logs}">
                    <td th:text="${#temporals.format(log.dataHora, 'dd/MM/yyyy HH:mm:ss')}">01/01/2024 10:00:00</td>
                    <td th:text="${log.email}">email@teste.com</td>
                    <td>
                        <span th:if="${log.sucesso}" style="color: green; font-weight: bold;">Sucesso</span>
                        <span th:if="${!log.sucesso}" style="color: red; font-weight: bold;">Falha</span>
                    </td>
                    <td th:text="${log.mensagem}">Login realizado</td>
                </tr>
            </tbody>
        </table>
    </div>
</body>

</html>